type Review {
  id: ID!
  cacheId: ID!
  productId: String!
  rating: Int!
  title: String
  text: String
  reviewerName: String
  shopperId: String
  location: String
  reviewDateTime: String
  verifiedPurchaser: Boolean
  sku: String
  approved: Boolean
  responseMessage: String
  authorEmail: String
  author: String
}

type ReviewsResult {
  data: [Review]
  range: Range
}

type Data {
  id: ID!
  cacheId: ID!
  productId: String!
  rating: Int!
  title: String
  text: String
  reviewerName: String
  shopperId: String
  location: String
  reviewDateTime: String
  verifiedPurchaser: Boolean
  sku: String
  approved: Boolean
}

type Range {
  total: Int
  from: Int
  to: Int
}

type AppSettings {
  allowAnonymousReviews: Boolean
  requireApproval: Boolean
  useLocation: Boolean
  defaultOpen: Boolean
  defaultOpenCount: Int
}

type Query {
  review(id: ID!): Review @cacheControl(scope: PRIVATE)
  reviews(
    searchTerm: String
    from: Int
    to: Int
    orderBy: String
    status: String
  ): ReviewsResult @cacheControl(scope: PRIVATE)
  reviewsByProductId(
    productId: String!
    from: Int
    to: Int
    orderBy: String
    status: String
  ): ReviewsResult @cacheControl(scope: PRIVATE)
  averageRatingByProductId(productId: String!): Float
    @cacheControl(scope: PRIVATE)
  totalReviewsByProductId(productId: String!): Int @cacheControl(scope: PRIVATE)
  reviewsByShopperId(
    shopperId: String!
    from: Int
    to: Int
    orderBy: String
    status: String
  ): ReviewsResult @cacheControl(scope: PRIVATE)
  hasShopperReviewed(shopperId: String!, productId: String!): Boolean
    @cacheControl(scope: PRIVATE)
  appSettings: AppSettings @cacheControl(scope: PRIVATE)
}

# Mutations

input ReviewInput {
  id: ID
  cacheId: ID
  productId: String!
  rating: Int!
  title: String
  text: String
  reviewerName: String
  location: String
  shopperId: String!
  reviewDateTime: String
  verifiedPurchaser: Boolean!
  sku: String
}

type Mutation {
  newReview(review: ReviewInput!): Review
  editReview(id: ID!, review: ReviewInput!): Review
  addResponse(id:ID!, reply:String, adminUserId:String): Boolean
  deleteReview(ids: [ID!]): Boolean
  moderateReview(ids: [ID!], approved: Boolean!): Boolean
}
